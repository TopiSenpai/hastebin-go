package templates

import (
	"fmt"
	"strconv"
)

templ Document(vars DocumentVars) {
	<!DOCTYPE html>
	<html lang="en" class={ vars.Theme }>
	@head(vars)
	<body>
	<div id="error-popup" style="display: none;"></div>
  <div style="width: 100%; display: flex; justify-content: space-between; align-items: center; padding: 1em 1.5em; background-color: #FFFFFF; color: #4f4f4f; font-family: Helvetica, sans-serif">
    <div style="display: flex; flex-direction: row; align-items: center; width: fit-content; line-height: 1.5">
      <img width="24" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iNDgiIHZpZXdCb3g9IjAgLTk2MCA5NjAgOTYwIiB3aWR0aD0iNDgiPjxwYXRoIGQ9Ik00NzkuOTgyLTI5MC43N3ExMS45MDIgMCAxOS41NzUtNy42NTUgNy42NzMtNy42NTYgNy42NzMtMTkuNTU4IDAtMTEuOTAyLTcuNjU1LTE5LjU3NXQtMTkuNTU3LTcuNjczcS0xMS45MDIgMC0xOS41NzUgNy42NTYtNy42NzMgNy42NTUtNy42NzMgMTkuNTU3IDAgMTEuOTAyIDcuNjU1IDE5LjU3NXQxOS41NTcgNy42NzNabS0yMC40NDMtMTQxLjA3Nmg0NS4zODN2LTI0OS41MzhoLTQ1LjM4M3YyNDkuNTM4Wm0yMC43OTQgMzMxLjg0NXEtNzguOTU1IDAtMTQ3Ljg5Ny0yOS45MnQtMTIwLjc1NS04MS43MXEtNTEuODE0LTUxLjc5MS04MS43NDctMTIwLjc3N3QtMjkuOTMzLTE0OC4wMjVxMC03OC42NTUgMjkuOTItMTQ3Ljg2NHQ4MS43MS0xMjAuNTIycTUxLjc5MS01MS4zMTQgMTIwLjc3Ny04MS4yNDd0MTQ4LjAyNS0yOS45MzNxNzguNjU1IDAgMTQ3Ljg2NCAyOS45MnQxMjAuNTIyIDgxLjIxcTUxLjMxNCA1MS4yOTEgODEuMjQ3IDEyMC42MjkgMjkuOTMzIDY5LjMzNyAyOS45MzMgMTQ3LjkwNyAwIDc4Ljk1NS0yOS45MiAxNDcuODk3dC04MS4yMSAxMjAuNTcxcS01MS4yOTEgNTEuNjI5LTEyMC42MjkgODEuNzQ2LTY5LjMzNyAzMC4xMTgtMTQ3LjkwNyAzMC4xMThabS4xNjctNDUuMzg0cTEzOS4xOTIgMCAyMzYuNjU0LTk3Ljc2OSA5Ny40NjEtOTcuNzY5IDk3LjQ2MS0yMzcuMzQ2IDAtMTM5LjE5Mi05Ny4yNzQtMjM2LjY1NFE2MjAuMDY3LTgxNC42MTUgNDgwLTgxNC42MTVxLTEzOS4wNzcgMC0yMzYuODQ2IDk3LjI3NFQxNDUuMzg1LTQ4MHEwIDEzOS4wNzcgOTcuNzY5IDIzNi44NDZUNDgwLjUtMTQ1LjM4NVpNNDgwLTQ4MFoiLz48L3N2Zz4=" />
      <div style="margin-left: 1em">
        This site has been acquired by <a style="color: #204fcf; font-weight: bold" href="https://disgo.dev">disgo.dev</a>.<br/>
        (<a style="color: #204fcf; font-weight: bold" href="https://www.youtube.com/watch?v=dQw4w9WgXcQ">Attention! Nothing has changed</a>)
      </div>
    </div>
    <div>
      <a style="color: #204fcf; font-weight: bold" href="https://www.youtube.com/watch?v=QB7ACr7pUuE">Apply as a Freelancer</a>
    </div>
  </div>
    <dialog id="share-dialog">
        <div class="share-dialog-header">
            <h2>Share</h2>
            <button id="share-dialog-close" class="icon-btn"></button>
        </div>
        <p>Share this URL with your friends and let them edit or delete the document.</p>
        <h3>Permissions</h3>
        <div class="share-dialog-main">
            <div class="share-dialog-permissions">
                <label for="share-permissions-write">Write</label>
                <input id="share-permissions-write" type="checkbox"/>

                <label for="share-permissions-delete">Delete</label>
                <input id="share-permissions-delete" type="checkbox"/>

                <label for="share-permissions-share">Share</label>
                <input id="share-permissions-share" type="checkbox"/>

                <label for="share-permissions-webhook">Webhook</label>
                <input id="share-permissions-webhook" type="checkbox"/>
            </div>
            <button id="share-copy">Copy</button>
        </div>
    </dialog>
	@header(vars)
	<main>
		<div id="files">
			for i, file := range vars.Files {
				<input id={ fmt.Sprintf("file-%d", i) } type="radio" name="files" value={ strconv.Itoa(i) }
                    if i == vars.CurrentFile {
                        checked
                    }
                />
                <label for={ fmt.Sprintf("file-%d", i) }><span>{ file.Name }</span><button class="file-remove" disabled?={ !vars.Edit }></button></label>
			}
			<div id="file-add"
				if !vars.Edit {
					style="display: none;"
				}
			></div>
		</div>
		<div id="content">
            <textarea id="code-edit" spellcheck="false" autocomplete="off"
	            if !vars.Edit {
	                style="display: none;"
	            }
            >{ vars.Files[vars.CurrentFile].Content }</textarea>
            <pre id="code"
                if vars.Edit {
                    style="display: none;"
                }
            ><code id="code-view" class="ch-chroma">@WriteUnsafe(vars.Files[vars.CurrentFile].Formatted)</code></pre>
		</div>
		<div id="footer">
            <select title="Version" id="version" autocomplete="off">
                for _, version := range vars.Versions {
                    <option title={ version.Time } value={ strconv.FormatInt(version.Version, 10) } selected?={ version.Version == vars.Version }>{ version.Label }</option>
                }
            </select>
            <select title="Style" id="style" autocomplete="off">
                for _, style := range vars.Styles {
                    <option value={ style.Name } data-theme={ style.Theme } selected?={ vars.Style == style.Name }>{ style.Name }</option>
                }
            </select>
            <label for="expire"
				if !vars.Edit {
				    style="display: none;"
				}
            >
            	<input title="Expire in" id="expire" type="number" min="0" placeholder="expire in"/>h
			</label>
            <div class="spacer"></div>
			<label for="code-edit">
			    <span id="code-edit-count" title="Document Size">{ strconv.Itoa(vars.TotalLength) }</span>
			    if vars.Max > 0 {
			        <span id="code-edit-max" title="Max Size">/{ strconv.FormatInt(vars.Max, 10) }</span>
			    }
			</label>
            <select title="Language" id="language" autocomplete="off">
                <option value="auto" selected?={ vars.Files[vars.CurrentFile].Language == "" }>auto</option>
                for _, lexer := range vars.Lexers {
                    <option value={ lexer } selected?={ vars.Files[vars.CurrentFile].Language == lexer }>{ lexer }</option>
                }
            </select>
        </div>
	</main>
	@WriteUnsafe(vars.StateJSON())
	<script src="/assets/script.js"></script>
	</body>
	</html>
}
